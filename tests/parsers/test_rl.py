import io
import numpy
from romsection.parsers import rl


def test_rl_decompress():
    data = b"\x30\x2a\x00\x00\
\x29\x73\xc0\x7d\xc0\x7e\xc0\x76\xc0\x0d\xc0\x26\xc4\x8f\xc0\x1d\
\xc0\x8a\xc0\x8b\xc0\x81\xc0\x28\xc0\x59\xcc\x1e\xc0\x97\xc0\x8c\
\xc0\x8d\xc0\x8d\xc0\x8d\xc0\x8e\xc0\x98\xc0"
    stream = io.BytesIO(data)
    result = rl.decompress(stream)
    assert len(result) == 42
    assert result == b"s\xc0}\xc0~\xc0v\xc0\r\xc0&\xc4\x8f\xc0\
\x1d\xc0\x8a\xc0\x8b\xc0\x81\xc0(\xc0Y\xcc\x1e\xc0\x97\xc0\
\x8c\xc0\x8d\xc0\x8d\xc0\x8d\xc0\x8e\xc0\x98\xc0"


def test_rl_check():
    data = b"\x30\x2a\x00\x00\
\x29\x73\xc0\x7d\xc0\x7e\xc0\x76\xc0\x0d\xc0\x26\xc4\x8f\xc0\x1d\
\xc0\x8a\xc0\x8b\xc0\x81\xc0\x28\xc0\x59\xcc\x1e\xc0\x97\xc0\x8c\
\xc0\x8d\xc0\x8d\xc0\x8d\xc0\x8e\xc0\x98\xc0"
    stream = io.BytesIO(data)
    result = rl.dryrun(stream)
    assert result == 42
